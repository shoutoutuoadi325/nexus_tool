# Nexus Repository å·¥å…·é›†

æŒ‰ç…§ gerrit_req æ¨¡å¼å®ç°çš„ Nexus Repository ç®¡ç†å·¥å…·é›† by å¼ ä¹‹éº’ï¼Œæä¾›äº†å®Œæ•´çš„ Nexus ä»“åº“æ“ä½œåŠŸèƒ½ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
nexus_tool/
â”œâ”€â”€ refs
â”‚   â”œâ”€â”€ env_config.py      # ç¯å¢ƒé…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ gerrit_req.py      # Gerritå·¥å…·ç±»ï¼ˆå‚è€ƒæ¨¡å¼ï¼‰
â”‚   â””â”€â”€ nexus_req.py       # Nexuså·¥å…·ç±»ï¼ˆæ ¸å¿ƒå®ç°ï¼‰
â”œâ”€â”€ nexus_cli.py           # å‘½ä»¤è¡Œå·¥å…·
â”œâ”€â”€ nexus_demo.py          # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ setup_nexus.py         # é…ç½®åŠ©æ‰‹
â”œâ”€â”€ NEXUS_README.md        # è¯¦ç»†APIæ–‡æ¡£
â””â”€â”€ README                 # æœ¬æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install requests loguru
```

### 2. é…ç½®NexusæœåŠ¡å™¨
```bash
python setup_nexus.py
```

### 3. ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
```bash
# åˆ—å‡ºä»“åº“ç»„ä»¶
python nexus_cli.py list maven-releases

# æœç´¢ç»„ä»¶
python nexus_cli.py search maven-central --group org.springframework

# ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
python nexus_cli.py download maven-central org.springframework spring-core --latest

# ä¸Šä¼ Mavenç»„ä»¶
python nexus_cli.py upload-maven maven-releases com.example my-lib 1.0.0 --jar my-lib.jar

# ä¸Šä¼ SASTæŠ¥å‘Š ğŸ†•
python nexus_cli.py upload-sast web-frontend sonar report.pdf --email-recipients security@company.com

# æ‰¹é‡ä¸Šä¼ SASTæŠ¥å‘Š ğŸ†•
python nexus_cli.py batch-upload-sast examples/batch_sast_config.json
```

### 4. åœ¨Pythonä»£ç ä¸­ä½¿ç”¨
```python
from refs.nexus_req import NexusReq

# æ ‡å‡†Nexusæ“ä½œ
nexus = NexusReq(default_account='admin')

# åˆ—å‡ºç»„ä»¶
components = nexus.list_components('maven-releases')

# æœç´¢ç»„ä»¶
result = nexus.search_components(repository='maven-central', group='org.springframework')

# ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
nexus.download_latest_version(
    repository='maven-central',
    group='org.springframework',
    name='spring-core'
)

# å¯ç”¨é‚®ä»¶é€šçŸ¥çš„Nexusæ“ä½œ ğŸ†•
nexus_with_email = NexusReq(
    default_account='admin',
    enable_email_notification=True,
    notification_recipients=['team@company.com']
)

# ä¸Šä¼ SASTæŠ¥å‘Š ğŸ†•
nexus_with_email.upload_sast_report(
    project_name='web-frontend',
    sast_category='sonar',
    files=['sonar-report.pdf', 'sonar-details.json'],
    scan_date='2024-01-15'
)

# æ‰¹é‡ä¸Šä¼ SASTæŠ¥å‘Š ğŸ†•  
batch_configs = [
    {
        'project_name': 'api-backend',
        'sast_category': 'checkmarx',
        'files': ['checkmarx-report.pdf']
    }
]
nexus_with_email.batch_upload_sast_reports(batch_configs)
```

## ğŸ¯ ä¸»è¦åŠŸèƒ½

### ç»„ä»¶ç®¡ç†
- âœ… åˆ—å‡ºä»“åº“ç»„ä»¶
- âœ… è·å–ç»„ä»¶è¯¦æƒ…
- âœ… åˆ é™¤ç»„ä»¶
- âœ… æ‰¹é‡åˆ é™¤ç»„ä»¶

### ä¸Šä¼ åŠŸèƒ½
- âœ… Mavenç»„ä»¶ä¸Šä¼ ï¼ˆjarã€pomã€sourcesã€javadocï¼‰
- âœ… Rawæ ¼å¼ä¸Šä¼ 
- âœ… NPMåŒ…ä¸Šä¼ 
- âœ… è‡ªåŠ¨POMç”Ÿæˆ
- âœ… SASTå·¥å…·æŠ¥å‘Šä¸Šä¼ ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼‰
- âœ… é‚®ä»¶é€šçŸ¥åŠŸèƒ½

### ä¸‹è½½åŠŸèƒ½
- âœ… èµ„äº§ä¸‹è½½
- âœ… æœç´¢å¹¶ä¸‹è½½
- âœ… ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
- âœ… æ‰¹é‡ä¸‹è½½
- âœ… æ”¯æŒåˆ†ç±»å™¨ï¼ˆsourcesã€javadocï¼‰

### æœç´¢åŠŸèƒ½
- âœ… ç»„ä»¶æœç´¢
- âœ… èµ„äº§æœç´¢
- âœ… é«˜çº§æœç´¢ï¼ˆæ”¯æŒMavenæ‰©å±•å‚æ•°ï¼‰
- âœ… åˆ†é¡µæœç´¢

### ä»“åº“ç®¡ç†
- âœ… ç»„ä»¶è¿ç§»ï¼ˆä»“åº“é—´è½¬ç§»ï¼‰
- âœ… ç‰ˆæœ¬æ¸…ç†
- âœ… æ‰¹é‡æ“ä½œ

### SASTå·¥å…·é›†æˆ ğŸ†•
- âœ… æ”¯æŒå¤šç§SASTå·¥å…·ï¼ˆSonarQubeã€Checkmarxã€Fortifyã€Coverityã€Veracodeï¼‰
- âœ… è‡ªåŠ¨æ–‡ä»¶éªŒè¯å’Œæ ¼å¼æ£€æŸ¥
- âœ… å¤šæ–‡ä»¶è‡ªåŠ¨æ‰“åŒ…ä¸Šä¼ 
- âœ… æŒ‰é¡¹ç›®å’Œæ—¥æœŸç»„ç»‡æŠ¥å‘Š
- âœ… æ‰¹é‡ä¸Šä¼ å¤šä¸ªé¡¹ç›®æŠ¥å‘Š
- âœ… SASTæŠ¥å‘Šæœç´¢å’Œä¸‹è½½

### é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ ğŸ†•
- âœ… æ“ä½œæˆåŠŸ/å¤±è´¥è‡ªåŠ¨é€šçŸ¥
- âœ… SASTä¸Šä¼ ä¸“ç”¨é€šçŸ¥æ¨¡æ¿
- âœ… æ”¯æŒHTMLé‚®ä»¶æ¨¡æ¿
- âœ… æ‰¹é‡æ“ä½œæ±‡æ€»é€šçŸ¥
- âœ… å¯é…ç½®SMTPæœåŠ¡å™¨
- âœ… å¤šæ”¶ä»¶äººæ”¯æŒ

## ğŸ› ï¸ å·¥å…·è¯´æ˜

### nexus_req.py - æ ¸å¿ƒå·¥å…·ç±»
æŒ‰ç…§gerrit_reqçš„æ¨¡å¼å®ç°çš„Nexus APIå°è£…ï¼Œæä¾›äº†å®Œæ•´çš„REST APIè®¿é—®åŠŸèƒ½ã€‚

**æ ¸å¿ƒç‰¹æ€§:**
- ç»Ÿä¸€çš„APIè°ƒç”¨æ¥å£
- å®Œå–„çš„é”™è¯¯å¤„ç†
- æ”¯æŒå¤šç§ä»“åº“æ ¼å¼
- å¹¶å‘æ‰¹é‡æ“ä½œ
- è‡ªåŠ¨æ–‡ä»¶ç®¡ç†

### nexus_cli.py - å‘½ä»¤è¡Œå·¥å…·
æä¾›å‹å¥½çš„å‘½ä»¤è¡Œæ¥å£ï¼Œæ”¯æŒæ‰€æœ‰å¸¸ç”¨æ“ä½œã€‚

**å¯ç”¨å‘½ä»¤:**
- `list` - åˆ—å‡ºç»„ä»¶
- `search` - æœç´¢ç»„ä»¶
- `download` - ä¸‹è½½ç»„ä»¶
- `upload-maven` - ä¸Šä¼ Mavenç»„ä»¶
- `upload-raw` - ä¸Šä¼ Rawç»„ä»¶
- `delete` - åˆ é™¤ç»„ä»¶
- `cleanup` - æ¸…ç†æ—§ç‰ˆæœ¬

### setup_nexus.py - é…ç½®åŠ©æ‰‹
äº¤äº’å¼é…ç½®å·¥å…·ï¼Œå¸®åŠ©å¿«é€Ÿè®¾ç½®NexusæœåŠ¡å™¨è¿æ¥ä¿¡æ¯ã€‚

**åŠŸèƒ½:**
- æœåŠ¡å™¨è¿æ¥æµ‹è¯•
- è´¦æˆ·éªŒè¯
- è‡ªåŠ¨é…ç½®æ–‡ä»¶æ›´æ–°
- é…ç½®å¤‡ä»½

### nexus_demo.py - ä½¿ç”¨ç¤ºä¾‹
å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºæ‰€æœ‰APIçš„ç”¨æ³•ã€‚

## ğŸ“– è¯¦ç»†æ–‡æ¡£

æŸ¥çœ‹ [NEXUS_README.md](NEXUS_README.md) è·å–å®Œæ•´çš„APIæ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜ã€‚

## ğŸ”§ é…ç½®è¯´æ˜

åœ¨ `refs/env_config.py` ä¸­é…ç½®NexusæœåŠ¡å™¨ä¿¡æ¯ï¼š

```python
NEXUS_INFO = {
    'domain': 'your-nexus-domain.com',
    'root_url': 'http://your-nexus-domain.com:8081',
    'accounts': {
        'admin': {
            'username': 'admin',
            'password': 'your-password'
        }
    }
}

# SMTPé‚®ä»¶é…ç½® ğŸ†•
SMTP_INFO = {
    'smtp_server': 'smtp.gmail.com',
    'smtp_port': 587,
    'use_tls': True,
    'accounts': {
        'default': {
            'username': 'your-email@gmail.com',
            'password': 'your-app-password',
            'from_name': 'Nexus Notification System'
        }
    }
}

# SASTå·¥å…·é…ç½® ğŸ†•
SAST_INFO = {
    'supported_formats': ['.pdf', '.doc', '.docx', '.txt', '.md', '.html', '.xml', '.json'],
    'max_file_size': 50 * 1024 * 1024,  # 50MB
    'default_repository': 'sast-reports-raw',
    'categories': {
        'sonar': 'SonarQubeæŠ¥å‘Š',
        'checkmarx': 'CheckmarxæŠ¥å‘Š',
        'fortify': 'FortifyæŠ¥å‘Š',
        'coverity': 'CoverityæŠ¥å‘Š',
        'veracode': 'VeracodeæŠ¥å‘Š',
        'generic': 'é€šç”¨SASTæŠ¥å‘Š'
    }
}
```

## ğŸŒŸ è®¾è®¡ç‰¹ç‚¹

### 1. æ¨¡å¼ä¸€è‡´æ€§
ä¸¥æ ¼æŒ‰ç…§ gerrit_req çš„è®¾è®¡æ¨¡å¼ï¼š
- ç›¸åŒçš„ç±»ç»“æ„å’Œæ–¹æ³•å‘½å
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶
- ä¸€è‡´çš„é…ç½®ç®¡ç†æ–¹å¼
- ç›¸åŒçš„æ—¥å¿—è®°å½•æ¨¡å¼

### 2. åŠŸèƒ½å®Œæ•´æ€§
æ¶µç›–Nexus Repositoryçš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼š
- CRUDæ“ä½œï¼ˆåˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ï¼‰
- æœç´¢å’ŒæŸ¥è¯¢
- æ‰¹é‡æ“ä½œ
- ä»“åº“ç®¡ç†

### 3. æ˜“ç”¨æ€§
- ç®€æ´çš„APIè®¾è®¡
- å‹å¥½çš„å‘½ä»¤è¡Œå·¥å…·
- å®Œå–„çš„ç¤ºä¾‹ä»£ç 
- è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜

### 4. å¥å£®æ€§
- å®Œå–„çš„é”™è¯¯å¤„ç†
- ç½‘ç»œå¼‚å¸¸é‡è¯•
- èµ„æºè‡ªåŠ¨æ¸…ç†
- å¹¶å‘å®‰å…¨æ§åˆ¶

## ğŸ”„ ç‰ˆæœ¬å¯¹æ¯”

| åŠŸèƒ½ | gerrit_req | nexus_req |
|------|-----------|-----------|
| è´¦æˆ·ç®¡ç† | âœ… | âœ… |
| é¡¹ç›®ç®¡ç† | âœ… | âœ… (ç»„ä»¶ç®¡ç†) |
| åˆ†ç»„ç®¡ç† | âœ… | âœ… (æœç´¢åŠŸèƒ½) |
| æ‰¹é‡æ“ä½œ | âœ… | âœ… |
| é”™è¯¯å¤„ç† | âœ… | âœ… |
| é…ç½®ç®¡ç† | âœ… | âœ… |
| æ–‡ä»¶ä¸Šä¼  | âŒ | âœ… |
| æ–‡ä»¶ä¸‹è½½ | âŒ | âœ… |
| å¤šæ ¼å¼æ”¯æŒ | âŒ | âœ… |

## ğŸ¤ ä½¿ç”¨å»ºè®®

### å¼€å‘ç¯å¢ƒ
1. ä½¿ç”¨é…ç½®åŠ©æ‰‹å¿«é€Ÿé…ç½®
2. è¿è¡Œç¤ºä¾‹ä»£ç éªŒè¯åŠŸèƒ½
3. æ ¹æ®éœ€è¦æ‰©å±•è‡ªå®šä¹‰åŠŸèƒ½

### ç”Ÿäº§ç¯å¢ƒ
1. ä½¿ç”¨ç‹¬ç«‹çš„éƒ¨ç½²ç”¨æˆ·
2. å¯ç”¨è¯¦ç»†æ—¥å¿—è®°å½•
3. é…ç½®é€‚å½“çš„è¶…æ—¶å’Œé‡è¯•
4. å®šæœŸå¤‡ä»½é‡è¦ç»„ä»¶

### è‡ªåŠ¨åŒ–é›†æˆ
1. CI/CDæµæ°´çº¿ä¸­ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
2. å®šæ—¶ä»»åŠ¡æ¸…ç†æ—§ç‰ˆæœ¬
3. æ‰¹é‡æ“ä½œå‡å°‘APIè°ƒç”¨æ¬¡æ•°

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æƒé™æ§åˆ¶**: ç¡®ä¿ä½¿ç”¨çš„è´¦æˆ·æœ‰è¶³å¤Ÿæƒé™
2. **ç½‘ç»œè¿æ¥**: ç¡®ä¿èƒ½å¤Ÿè®¿é—®NexusæœåŠ¡å™¨
3. **ä»“åº“å­˜åœ¨**: æ“ä½œå‰ç¡®ä¿ç›®æ ‡ä»“åº“å·²åˆ›å»º
4. **æ–‡ä»¶è·¯å¾„**: ä½¿ç”¨ç»å¯¹è·¯å¾„é¿å…è·¯å¾„é—®é¢˜
5. **å¹¶å‘æ§åˆ¶**: æ‰¹é‡æ“ä½œæ—¶æ³¨æ„æœåŠ¡å™¨å‹åŠ›

### SASTå·¥å…·ä½¿ç”¨æ³¨æ„äº‹é¡¹ ğŸ†•
6. **æ–‡ä»¶æ ¼å¼**: æ”¯æŒ.pdfã€.docã€.docxã€.txtã€.mdã€.htmlã€.xmlã€.jsonæ ¼å¼
7. **æ–‡ä»¶å¤§å°**: å•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡50MB
8. **ä»“åº“é…ç½®**: ç¡®ä¿SASTæŠ¥å‘Šä»“åº“å·²åˆ›å»ºï¼ˆé»˜è®¤ï¼šsast-reports-rawï¼‰
9. **ç›®å½•ç»“æ„**: æŠ¥å‘ŠæŒ‰é¡¹ç›®å/å·¥å…·ç±»å‹/æ‰«ææ—¥æœŸç»„ç»‡

### é‚®ä»¶é€šçŸ¥æ³¨æ„äº‹é¡¹ ğŸ†•
10. **SMTPé…ç½®**: ç¡®ä¿SMTPæœåŠ¡å™¨é…ç½®æ­£ç¡®
11. **é‚®ç®±å¯†ç **: å»ºè®®ä½¿ç”¨åº”ç”¨ä¸“ç”¨å¯†ç 
12. **æ¨¡æ¿ç›®å½•**: ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºé‚®ä»¶æ¨¡æ¿ï¼Œä¹Ÿå¯è‡ªå®šä¹‰
13. **æ”¶ä»¶äººæ ¼å¼**: å¤šä¸ªæ”¶ä»¶äººç”¨é€—å·åˆ†éš”

## ğŸ“ è®¸å¯è¯

Apache-2.0 License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼